<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan de l'h√¥pital</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="map-container">
        <img src="plan_hopital.jpg" id="map-image" alt="Plan de l'h√¥pital">
        <div id="user-location"></div> <!-- Point bleu de g√©olocalisation -->
    </div>
    <button id="location-btn">Activer la localisation</button>
    <script>

        let watchID = null;

// Fonction pour d√©marrer le suivi de position
function startTracking() {
    if (navigator.geolocation) {
        watchID = navigator.geolocation.watchPosition(updatePosition, showError, {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        });
    } else {
        alert("Votre navigateur ne supporte pas la g√©olocalisation.");
    }
}

// Fonction pour afficher les erreurs de g√©olocalisation
function showError(error) {
    switch (error.code) {
        case error.PERMISSION_DENIED:
            alert("Autorisez la localisation pour voir votre position.");
            break;
        case error.POSITION_UNAVAILABLE:
            alert("Localisation indisponible.");
            break;
        case error.TIMEOUT:
            alert("La localisation a expir√©.");
            break;
        default:
            alert("Erreur inconnue.");
    }
}

// Met √† jour la position du point sur le plan
function updatePosition(position) {
    let accuracy = position.coords.accuracy;
    let longitude = position.coords.longitude;
    let latitude = position.coords.latitude;

    // Affichage des coordonn√©es dans la console pour d√©bogage
    console.log("üìç Position utilisateur : Longitude =", longitude, "Latitude =", latitude, "Pr√©cision =", accuracy, "m");

    // Si la pr√©cision est trop mauvaise, on ignore cette position
    if (accuracy > 20) {
        console.warn("Position ignor√©e car trop impr√©cise.");
        return;
    }

    // Bornes GPS du plan de l'h√¥pital
    let longitude_min = 1.4598, longitude_max = 1.4602;
    let latitude_min = 43.6280, latitude_max = 43.6277;

    console.log("üñºÔ∏è Bornes du plan : Longitude min/max =", longitude_min, longitude_max, "Latitude min/max =", latitude_min, latitude_max);

    // Calcul de la position sur le plan en pourcentage
    let longitude_percentage = ((longitude - longitude_min) / (longitude_max - longitude_min)) * 100;
    let latitude_percentage = ((latitude_min - latitude) / (latitude_min - latitude_max)) * 100;

    console.log("üéØ Position sur le plan (en %) : X =", longitude_percentage, "%", "Y =", latitude_percentage, "%");

    // V√©rifie si l'utilisateur est bien dans la zone d√©finie
    if (longitude >= longitude_min && longitude <= longitude_max && latitude <= latitude_min && latitude >= latitude_max) {
        // Positionnement du point bleu
        let userLocation = document.getElementById("user-location");
        userLocation.style.left = longitude_percentage + "%";
        userLocation.style.top = latitude_percentage + "%";
        userLocation.style.display = "block"; // Affichage du point
        console.log("‚úÖ Point g√©olocalis√© au centre de l'√©cran");
    } else {
        alert("Vous √™tes en dehors de la zone d√©finie.");
        console.warn("Position hors de la zone !");
    }
}

// Bouton pour activer la g√©olocalisation
document.getElementById("location-btn").addEventListener("click", startTracking);

    </script>
</body>
</html>
